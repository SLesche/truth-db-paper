---
editor_options:
  chunk_output_type: console
---
<!-- # Library calls -->
```{r data-prep-setup}
library(tidyverse)
library(data.table)
library(acdcquery)
```

```{r}
conn <- connect_to_db("./markdown/data/ted.db")

all_argument <- list() %>% 
  add_argument(
    conn,
    "publication_id",
    "greater",
    "0"
  )

phase_argument <- list() %>% 
  add_argument(
    conn,
    "phase",
    "equal",
    "test"
  )
```

```{r}
publications_overview <- query_db(
  conn,
  all_argument,
  "default",
  "publication_table"
)

study_overview <- query_db(
  conn,
  all_argument,
  "default",
  "study_table"
)

full_data <- query_db(
  conn,
  all_argument,
  c("default", "study_id", "publication_id", "statement_text", "statement_accuracy", "statementset_id", "statementset_publication", "within_description", "between_description", "repetition_time", "n_statements", "phase"),
  "observation_table"
)

write.csv(full_data, "./markdown/data/full_data.csv")
```



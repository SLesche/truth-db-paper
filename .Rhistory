results$eta_sq %>% hist(breaks = 10)
results$omega_sq %>% hist()
results
procedure_data <- query_db(
conn,
list() %>%
add_argument(
conn,
"procedure_id",
"greater",
"0"
),
"default",
"procedure_table"
)
View(procedure_data)
study_overview
View(study_overview)
View(publications_overview)
View(procedure_data)
weighted.mean(study_overview$participants_age, study_overview$n_participants)
study_overview$n_participants
study_overview$participants_age
weighted.mean(study_overview$participant_age, study_overview$n_participants)
weighted.mean(study_overview$participant_age, study_overview$n_participants, na.rm = TRUE)
weighted.sd(study_overview$participant_age, study_overview$n_participants, na.rm = TRUE)
DescTools::sd(study_overview$participant_age, weights = study_overview$n_participants, na.rm = TRUE)
DescTools::SD(study_overview$participant_age, weights = study_overview$n_participants, na.rm = TRUE)
DescTools::SD(study_overview$participant_age, weights = study_overview$n_participants)
study_overview
study_overview$n_participants
study_overview$participant_age
DescTools::SD(study_overview$participant_age, weights = study_overview$n_participants, na.rm = TRUE)
age_data <- study_overview %>%
mutate(participant_age = ifelse(participant_age == 99, NA, participant_age)) %>%
filter(!is.na(participant_age), !is.na(n_participants))
weighted.mean(age_data$participant_age, age_data$n_participants, na.rm = TRUE)
DescTools::SD(age_data$participant_age, weights = age_data$n_participants, na.rm = TRUE)
mean(study_overview$n_participants, na.rm = TRUE)
min(study_overview$n_participants, na.rm = TRUE)
max(study_overview$n_participants, na.rm = TRUE)
# Big LM Model
model_0 <- lme4::lmer(response ~ repeated + (1 | procedure_id) + (1 | subject), data = analysis_data)
summary(model_0)
analysis_data
colnames(analysis_data)
# Big LM Model
model_0 <- lme4::lmer(response ~ repetition_time + repeated + (1 | procedure_id) + (1 | subject), data = analysis_data)
summary(model_0)
# Big LM Model
model_0 <- lme4::lmer(response ~ repetition_time/(24*60)* repeated + (1 | procedure_id) + (1 | subject), data = analysis_data)
analysis_data$repetition_time_days = analysis_data$repetition_time/ (24*60)
# Big LM Model
model_0 <- lme4::lmer(response ~ repetition_time_days * repeated + (1 | procedure_id) + (1 | subject), data = analysis_data)
summary(model_0)
full_data <- query_db(
conn,
all_argument,
c("default", "study_id", "publication_id", "statement_text", "statement_accuracy", "statementset_id", "statementset_publication", "within_description", "between_description", "repetition_time", "n_statements", "phase", "truth_instructions", "repetition_instructions", "truth_instructions_timing", "repetition_instructions_timing"),
"observation_table"
)
full_data <- query_db(
conn,
all_argument,
c("default", "study_id", "publication_id", "statement_text", "statement_accuracy", "statementset_id", "statementset_publication", "within_description", "between_description", "repetition_time", "n_statements", "phase", "truth_instructions", "repetition_instructions", "truth_instruction_timing", "repetition_instruction_timing"),
"observation_table"
)
full_data %>% count(truth_instructions)
full_data %>% count(repetition_instructions)
full_data %>% count(repetition_instruction_timing)
full_data %>% count(truth_instruction_timing)
analysis_data <- full_data %>%
filter(phase == "test") %>%
filter(!is.na(repeated), !is.na(response))
analysis_data <- full_data %>%
filter(phase == "test")
# Big LM Model
model_0 <- lme4::lmer(response ~ truth_instructions * repeated + (1 | procedure_id) + (1 | subject), data = analysis_data)
summary(model_0)
# Big LM Model
model_0 <- lme4::lmer(response ~ truth_instructions * repeated + statement_accuracy + (1 | procedure_id) + (1 | subject), data = analysis_data)
summary(model_0)
# Big LM Model
model_0 <- lme4::lmer(response ~ repeated + statement_accuracy + repeated:statement_accuracy + repeated:truth_instructions (1 | procedure_id) + (1 | subject), data = analysis_data)
# Big LM Model
model_0 <- lme4::lmer(response ~ repeated + statement_accuracy + repeated:statement_accuracy + repeated:truth_instructions + (1 | procedure_id) + (1 | subject), data = analysis_data)
summary(model_0)
analysis_data %>% count(statement_accuracy)
hist(analysis_data$response)
study_overview %>% count(truth_rating_scale)
study_overview %>% count(truth_rating_steps)
effect_by_subject <- analysis_data %>%
group_by(subject, repeated, n_statements, repetition_time, procedure_id) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE)
) %>%
pivot_wider(
names_from = "repeated",
names_prefix = "repeated_",
values_from = "mean_resp"
) %>%
mutate(
effect = repeated_1 - repeated_0,
combination = interaction(subject, procedure_id),
) %>%
ungroup()
effect_by_subject <- analysis_data %>%
group_by(subject, repeated, n_statements, repetition_time, contains("instruction"), procedure_id) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE)
) %>%
pivot_wider(
names_from = "repeated",
names_prefix = "repeated_",
values_from = "mean_resp"
) %>%
mutate(
effect = repeated_1 - repeated_0,
combination = interaction(subject, procedure_id),
) %>%
ungroup()
effect_by_subject <- analysis_data %>%
group_by(subject, repeated, n_statements, repetition_time, truth_instructions, truth_instruction_timing, repetition_instruction_timing, repetition_instructions, procedure_id) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE)
) %>%
pivot_wider(
names_from = "repeated",
names_prefix = "repeated_",
values_from = "mean_resp"
) %>%
mutate(
effect = repeated_1 - repeated_0,
combination = interaction(subject, procedure_id),
) %>%
ungroup()
# Big LM Model
model_0 <- lme4::lmer(effect ~ truth_instructions + (1 | procedure_id) + (1 | subject), data = effect_by_subject)
summary(model_0)
# Big LM Model
model_0 <- lme4::lmer(effect ~ truth_instructions + (1 | procedure_id), data = effect_by_subject)
summary(model_0)
hist(analysis_data$repeated)
hist(analysis_data$response)
hist(effect_by_subject$effect)
hist(effect_by_subject$effect, breaks = 50)
hist(effect_by_subject$effect, breaks = 60)
hist(effect_by_subject$effect, breaks = 80)
mean(effect_by_subject$effect)
mean(effect_by_subject$effect, na.rm = TRUE)
sd(effect_by_subject$effect, na.rm = TRUE)
DescTools::Skew(effect_by_subject$effect, na.rm = TRUE)
DescTools::Kurt(effect_by_subject$effect, na.rm = TRUE)
analysis_data %>% left_join(study_id)
analysis_data %>% left_join(study_overview)
DescTools::Kurt(effect_by_subject$effect, na.rm = TRUE) %>% filter(truth_rating_steps != 2) %>% pull(response) %>% hist()
analysis_data %>% left_join(study_overview)%>% filter(truth_rating_steps != 2) %>% pull(response) %>% hist()
analysis_data %>% left_join(study_overview)%>% filter(truth_rating_steps == 2) %>% pull(response) %>% hist()
DescTools::Kurt(effect_by_subject$effect, na.rm = TRUE) %>% filter(truth_rating_steps != 6) %>% pull(response) %>% hist()
DescTools::Kurt(effect_by_subject$effect, na.rm = TRUE) %>% filter(truth_rating_steps == 6) %>% pull(response) %>% hist()
analysis_data %>% left_join(study_overview)%>% filter(truth_rating_steps == 6) %>% pull(response) %>% hist()
study_overview %>% count(truth_rating_steps)
analysis_data %>% left_join(study_overview)%>% filter(truth_rating_steps != 2) %>% pull(response) %>% hist()
analysis_data %>%
group_by(truth_instruction_timing) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE)
)
analysis_data %>%
group_by(truth_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE)
)
analysis_data %>%
group_by(truth_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n()
)
split_by_truth_instructions <- analysis_data %>%
group_by(truth_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n()
) %>%
filter(!is.na(repeated))
split_by_repetition_instructions <- analysis_data %>%
group_by(truth_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n()
) %>%
filter(!is.na(repeated))
split_by_repetition_instructions <- analysis_data %>%
group_by(repetition_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n()
) %>%
filter(!is.na(repeated))
split_by_repetition_instructions
split_by_truth_instructions
split_by_repetition_instructions <- analysis_data %>%
group_by(repetition_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n(),
n_studies = length(unique(study_id)),
) %>%
filter(!is.na(repeated))
split_by_truth_instructions <- analysis_data %>%
group_by(truth_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n(),
n_studies = length(unique(study_id)),
) %>%
filter(!is.na(repeated))
split_by_repetition_instructions <- analysis_data %>%
group_by(repetition_instruction_timing, repeated) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE),
sd_resp = sd(response, na.rm = TRUE),
n = n(),
n_studies = length(unique(study_id)),
) %>%
filter(!is.na(repeated))
split_by_truth_instructions
split_by_repetition_instructions
library(tidyverse)
library(data.table)
library(lme4)
library(afex)
full_data <- data.table::fread("markdown/data/full_data.csv")
analysis_data <- full_data %>%
filter(phase == "test") %>%
filter(!is.na(repeated), !is.na(response))
has_complete_data <- analysis_data %>%
count(procedure_id, subject, repeated) %>%
count(procedure_id, subject) %>%
mutate(
has_complete_data = ifelse(n == 2, 1, 0)
)
analysis_data <- analysis_data %>%
left_join(
., has_complete_data
) %>%
filter(has_complete_data == 1)
has_complete_data <- analysis_data %>%
count(procedure_id, subject, repeated) %>%
count(procedure_id, subject) %>%
mutate(
has_complete_data = ifelse(n == 2, 1, 0)
)
analysis_data <- analysis_data %>%
left_join(
., has_complete_data
) %>%
filter(has_complete_data == 1)
conn <- connect_to_db("./markdown/data/ted.db")
library(tidyverse)
library(data.table)
library(acdcquery)
conn <- connect_to_db("./markdown/data/ted.db")
all_argument <- list() %>%
add_argument(
conn,
"publication_id",
"greater",
"0"
)
phase_argument <- list() %>%
add_argument(
conn,
"phase",
"equal",
"test"
)
publications_overview <- query_db(
conn,
all_argument,
"default",
"publication_table"
)
study_overview <- query_db(
conn,
all_argument,
"default",
"study_table"
)
full_data <- query_db(
conn,
all_argument,
c("default", "study_id", "publication_id", "statement_text", "statement_accuracy", "statementset_id", "statementset_publication", "within_description", "between_description", "repetition_time", "n_statements", "phase", "truth_instructions", "repetition_instructions", "truth_instruction_timing", "repetition_instruction_timing", "truth_rating_scale", "truth_rating_steps"),
"observation_table"
)
data.table::fwrite(full_data, "./markdown/data/full_data.csv")
data.table::fwrite(full_data, "./markdown/data/full_data.csv")
full_data <- data.table::fread("markdown/data/full_data.csv")
analysis_data <- full_data %>%
filter(phase == "test") %>%
filter(!is.na(repeated), !is.na(response))
has_complete_data <- analysis_data %>%
count(procedure_id, subject, repeated) %>%
count(procedure_id, subject) %>%
mutate(
has_complete_data = ifelse(n == 2, 1, 0)
)
analysis_data <- analysis_data %>%
left_join(
., has_complete_data
) %>%
filter(has_complete_data == 1)
dichotomous_data <- analysis_data %>%
filter(truth_rating_scale == "dichotomous")
scale_data <- analysis_data %>%
filter(truth_rating_scale != "dichotomous")
analysis_data <- full_data %>%
filter(phase == "test") %>%
filter(!is.na(repeated), !is.na(response)) %>%
mutate(
truth_instruction_timing = ifelse(
truth_instruction_timing == "",
"none",
truth_instruction_timing
),
repetition_instruction_timing = ifelse(
repetition_instruction_timing == "",
"none",
repetition_instruction_timing
)
)
has_complete_data <- analysis_data %>%
count(procedure_id, subject, repeated) %>%
count(procedure_id, subject) %>%
mutate(
has_complete_data = ifelse(n == 2, 1, 0)
)
analysis_data <- analysis_data %>%
left_join(
., has_complete_data
) %>%
filter(has_complete_data == 1)
dichotomous_data <- analysis_data %>%
filter(truth_rating_scale == "dichotomous")
scale_data <- analysis_data %>%
filter(truth_rating_scale != "dichotomous")
unique(analysis_data$repetition_time)
analysis_data %>% count(repetition_time)
60*24
analysis_data <- full_data %>%
filter(phase == "test") %>%
filter(!is.na(repeated), !is.na(response)) %>%
mutate(
truth_instruction_timing = ifelse(
truth_instruction_timing == "",
"none",
truth_instruction_timing
),
repetition_instruction_timing = ifelse(
repetition_instruction_timing == "",
"none",
repetition_instruction_timing
),
repetition_time_type = case_when(
repetition_time <= 5 ~ "immediate",
repetition_time > 5 & repetition_time <= 60 ~ "delay",
repetition_time > 60*24 ~ "next_day"
)
)
has_complete_data <- analysis_data %>%
count(procedure_id, subject, repeated) %>%
count(procedure_id, subject) %>%
mutate(
has_complete_data = ifelse(n == 2, 1, 0)
)
analysis_data <- analysis_data %>%
left_join(
., has_complete_data
) %>%
filter(has_complete_data == 1)
dichotomous_data <- analysis_data %>%
filter(truth_rating_scale == "dichotomous")
scale_data <- analysis_data %>%
filter(truth_rating_scale != "dichotomous")
model_full_dichotomous <- lmer(
response ~ repeated + statement_accuracy + truth_instruction_timing:repeated +
repetition_time_type + repetition_instruction_timing:repeated + repetition_instruction_timing:truth_instruction_timing:repeated +
(1 | subject) + (1 | statement_id) + (1 | procedure_id)
)
?lmer
?glmer
model_full_dichotomous <- glmer(
response ~ repeated + statement_accuracy + truth_instruction_timing:repeated +
repetition_time_type + repetition_instruction_timing:repeated + repetition_instruction_timing:truth_instruction_timing:repeated +
(1 | subject) + (1 | statement_id) + (1 | procedure_id),
data = dichotomous_data,
family = binomial()
)
model_0_dichotomous <- glmer(
response ~ repeated + (1 | subject) + (1 | statement_id) + (1 | procedure_id),
data = dichotomous_data,
family = binomial()
)
summary(model_0_dichotomous)
e^0.1
exp(0.1)
model_0_likert <- lmer(
response ~ repeated + (1 | subject) + (1 | statement_id) + (1 | procedure_id),
data = scale_data
)
summary(model_0_likert)
effect_by_subject <- analysis_data %>%
group_by(subject, repeated, n_statements, repetition_time, truth_instructions, truth_instruction_timing, repetition_instruction_timing, repetition_instructions, procedure_id) %>%
summarize(
mean_resp = mean(response, na.rm = TRUE)
) %>%
pivot_wider(
names_from = "repeated",
names_prefix = "repeated_",
values_from = "mean_resp"
) %>%
mutate(
effect = repeated_1 - repeated_0,
combination = interaction(subject, procedure_id),
) %>%
ungroup()
effect_by_subject %>%
ggplot(
aes(
x = fct_reorder(combination, effect),
y = effect,
)
)+
geom_point()+
geom_hline(yintercept = 0,
col = "red")+
labs(
x = "Subject",
y = "Truth Effect"
)
effect_by_subject %>%
count(procedure_id, effect > 0) %>%
pivot_wider(
names_from = "effect > 0",
values_from = n,
names_prefix = "eff_present"
) %>%
mutate(
n_subjects = eff_presentTRUE + eff_presentFALSE,
percent_showing = eff_presentTRUE  / (eff_presentTRUE + eff_presentFALSE)
) %>%
pull(percent_showing) %>%
hist()
effect_by_subject %>%
count(procedure_id, effect > 0) %>%
pivot_wider(
names_from = "effect > 0",
values_from = n,
names_prefix = "eff_present"
) %>%
mutate(
n_subjects = eff_presentTRUE + eff_presentFALSE,
percent_showing = eff_presentTRUE  / (eff_presentTRUE + eff_presentFALSE)
) %>%
pull(percent_showing) %>%
hist(breaks = 30)
effect_by_subject %>%
count(procedure_id, effect > 0) %>%
pivot_wider(
names_from = "effect > 0",
values_from = n,
names_prefix = "eff_present"
) %>%
mutate(
n_subjects = eff_presentTRUE + eff_presentFALSE,
percent_showing = eff_presentTRUE  / (eff_presentTRUE + eff_presentFALSE)
) %>%
pull(percent_showing) %>%
hist(breaks = 20)
effect_by_subject %>%
count(procedure_id, effect > 0) %>%
pivot_wider(
names_from = "effect > 0",
values_from = n,
names_prefix = "eff_present"
) %>%
mutate(
n_subjects = eff_presentTRUE + eff_presentFALSE,
percent_showing = eff_presentTRUE  / (eff_presentTRUE + eff_presentFALSE)
) %>%
pull(percent_showing) %>%
hist(breaks = 10)
effect_by_subject %>%
count(procedure_id, effect > 0) %>%
pivot_wider(
names_from = "effect > 0",
values_from = n,
names_prefix = "eff_present"
) %>%
mutate(
n_subjects = eff_presentTRUE + eff_presentFALSE,
percent_showing = eff_presentTRUE  / (eff_presentTRUE + eff_presentFALSE)
) %>%
pull(percent_showing) %>%
hist(breaks = 20)
